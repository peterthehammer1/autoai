{
  "agent_name": "Alex - Premier Auto Service",
  "voice_id": "eleven_turbo_v2",
  "llm": "claude-3-5-haiku-20241022",
  "language": "en-US",
  "ambient_sound": "office",
  
  "functions": [
    {
      "name": "lookup_customer",
      "description": "Look up a customer by their phone number to check if they are a returning customer and retrieve their vehicle information. Call this at the start of every conversation using the caller's phone number.",
      "url": "{{BASE_URL}}/api/retell/lookup_customer",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "phone_number": {
            "type": "string",
            "description": "The customer's phone number in any format (e.g., '555-234-5678' or '5552345678')"
          }
        },
        "required": ["phone_number"]
      }
    },
    {
      "name": "get_services",
      "description": "Get available services. Use when customer asks what services are offered, needs to find a specific service, or you need to look up service details. Can filter by category or search term.",
      "url": "{{BASE_URL}}/api/retell/get_services",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "category": {
            "type": "string",
            "description": "Filter by category: 'Oil & Fluids', 'Tires & Wheels', 'Brakes', 'Battery & Electrical', 'Engine & Transmission', 'Heating & Cooling', 'Inspection & Diagnostic', 'Scheduled Maintenance'"
          },
          "search": {
            "type": "string",
            "description": "Search term to find services by name (e.g., 'oil change', 'alignment', 'brakes')"
          },
          "mileage": {
            "type": "integer",
            "description": "Customer's vehicle mileage to get maintenance recommendations"
          }
        },
        "required": []
      }
    },
    {
      "name": "check_availability",
      "description": "Check available appointment time slots for specific services. Call this after identifying what service the customer needs and when they'd like to come in.",
      "url": "{{BASE_URL}}/api/retell/check_availability",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "service_ids": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Array of service IDs to book (get these from get_services)"
          },
          "preferred_date": {
            "type": "string",
            "description": "Preferred date in YYYY-MM-DD format (e.g., '2024-02-15')"
          },
          "preferred_time": {
            "type": "string",
            "description": "Time preference: 'morning' (7am-12pm), 'afternoon' (12pm-6pm), or specific time like '09:00'"
          },
          "days_to_check": {
            "type": "integer",
            "description": "Number of days to search for availability (default: 7, max: 14)"
          }
        },
        "required": ["service_ids"]
      }
    },
    {
      "name": "book_appointment",
      "description": "Book a confirmed appointment. Only call this after the customer has confirmed the date, time, and service they want. Requires phone number, at least one service, date, and time.",
      "url": "{{BASE_URL}}/api/retell/book_appointment",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "customer_phone": {
            "type": "string",
            "description": "Customer's phone number"
          },
          "customer_first_name": {
            "type": "string",
            "description": "Customer's first name (for new customers)"
          },
          "customer_last_name": {
            "type": "string",
            "description": "Customer's last name (for new customers)"
          },
          "customer_email": {
            "type": "string",
            "description": "Customer's email address (optional)"
          },
          "vehicle_id": {
            "type": "string",
            "description": "ID of existing vehicle from lookup_customer (for returning customers)"
          },
          "vehicle_year": {
            "type": "integer",
            "description": "Vehicle year (for new vehicles)"
          },
          "vehicle_make": {
            "type": "string",
            "description": "Vehicle make, e.g., 'Honda', 'Toyota' (for new vehicles)"
          },
          "vehicle_model": {
            "type": "string",
            "description": "Vehicle model, e.g., 'Civic', 'Camry' (for new vehicles)"
          },
          "vehicle_mileage": {
            "type": "integer",
            "description": "Current vehicle mileage in km (optional)"
          },
          "service_ids": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Array of service IDs to book"
          },
          "appointment_date": {
            "type": "string",
            "description": "Appointment date in YYYY-MM-DD format"
          },
          "appointment_time": {
            "type": "string",
            "description": "Appointment time in HH:MM format (24-hour, e.g., '09:30')"
          },
          "loaner_requested": {
            "type": "boolean",
            "description": "Whether customer needs a loaner vehicle"
          },
          "shuttle_requested": {
            "type": "boolean",
            "description": "Whether customer needs shuttle service"
          },
          "notes": {
            "type": "string",
            "description": "Any special requests or notes from the customer"
          }
        },
        "required": ["customer_phone", "service_ids", "appointment_date", "appointment_time"]
      }
    },
    {
      "name": "get_customer_appointments",
      "description": "Get a customer's existing appointments. Call when customer asks about their upcoming appointments, wants to know when their appointment is, or needs to reschedule/cancel.",
      "url": "{{BASE_URL}}/api/retell/get_customer_appointments",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "customer_phone": {
            "type": "string",
            "description": "Customer's phone number"
          },
          "status": {
            "type": "string",
            "description": "'upcoming' for future appointments only, or 'all' for complete history"
          }
        },
        "required": ["customer_phone"]
      }
    },
    {
      "name": "modify_appointment",
      "description": "Cancel or reschedule an existing appointment. Use after confirming which appointment and what action the customer wants.",
      "url": "{{BASE_URL}}/api/retell/modify_appointment",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "appointment_id": {
            "type": "string",
            "description": "The appointment ID from get_customer_appointments"
          },
          "action": {
            "type": "string",
            "enum": ["cancel", "reschedule"],
            "description": "'cancel' to cancel the appointment, 'reschedule' to change the date/time"
          },
          "new_date": {
            "type": "string",
            "description": "New date in YYYY-MM-DD format (required for reschedule)"
          },
          "new_time": {
            "type": "string",
            "description": "New time in HH:MM format (required for reschedule)"
          },
          "reason": {
            "type": "string",
            "description": "Reason for cancellation (optional)"
          }
        },
        "required": ["appointment_id", "action"]
      }
    }
  ]
}
